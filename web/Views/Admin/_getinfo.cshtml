@model List<Models2.Employee.Listmodel>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="Smarthr - Bootstrap Admin Template">
    <meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern, accounts, invoice, html5, responsive, CRM, Projects">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Dashboard - HRMS template</title>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="~/Content/assets/img/favicon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="~/Content/assets/css/bootstrap.min.css">
    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="~/Content/assets/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="~/Content/assets/plugins/fontawesome/css/all.min.css">

    <!-- Lineawesome CSS -->
    <link rel="stylesheet" href="~/Content/assets/css/line-awesome.min.css">
    <link rel="stylesheet" href="~/Content/assets/css/material.css">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="~/Content/assets/css/font-awesome.min.css">

    <!-- Lineawesome CSS -->
    <link rel="stylesheet" href="~/Content/assets/css/line-awesome.min.css">

    <!-- Chart CSS -->
    <link rel="stylesheet" href="~/Content/assets/plugins/morris/morris.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="~/Content/assets/css/style.css">

    <!-- Custom JS -->
    <script src="~/Content/assets/js/app.js"></script>
    <script src="~/Scripts/Partial.js"></script>

    <!-- jQuery -->
    <script src="~/Content/assets/js/jquery-3.6.0.min.js"></script>

</head>

<div class="content container-fluid">
    <h4>Car Request</h4>
    <div class="row">
        <div class="col-md-12">
            <div class="table-responsive">
                <table class="table table-striped custom-table mb-0 datatable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>SingleOrReturn</th>
                            <th>Destination</th>
                            <th>Date</th>
                            <th>Destination City</th>
                            <th>Destination State</th>
                            <th>Number of Days</th>
                            <th>Source</th>
                            <th>Source City</th>
                            <th>Source State</th>
                            <th>Purpose</th>
                            <th>E_Id</th>
                            <th>Allot_Id</th>
                            <th>Res_Id</th>
                            <th>StartTime</th>
                            <th>EndTime</th>
                            <th>Status</th>

                        </tr>

                    </thead>
                    <tbody>
                        @foreach (var x in ViewBag.list1)
                        {
                            <tr>
                                <td>@x.Id</td>
                                <td>@x.SingleOrReturn</td>
                                <td>@x.Destination</td>
                                <td>@x.Date</td>
                                <td>@x.DestinationCity</td>
                                <td>@x.DestinationState</td>
                                <td>@x.NumberOfDays</td>
                                <td>@x.Source</td>
                                <td>@x.SourceCity</td>
                                <td>@x.SourceState</td>
                                <td>@x.Purpose</td>
                                <td>@x.E_Id</td>
                                <td>@x.Allot_Id</td>
                                <td>@x.Res_Id</td>
                                <td>@x.StartTime</td>
                                <td>@x.EndTime</td>
                                <td>@x.Status</td>

                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="content container-fluid">
        <h4>Truck Request</h4>
        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table table-striped custom-table mb-0 datatable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Employee ID</th>
                                <th>Venue</th>
                                <th>Phone Number</th>
                                <th>Purpose</th>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Request For</th>
                                <th>Res ID</th>
                                <th>Allot ID</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var truckRequest in ViewBag.list2)
                            {
                                <tr>
                                    <td>@truckRequest.id</td>
                                    <td>@truckRequest.EmployeeId</td>
                                    <td>@truckRequest.Venue</td>
                                    <td>@truckRequest.PhoneNumber</td>
                                    <td>@truckRequest.Purpose</td>
                                    <td>@truckRequest.Date</td>
                                    <td>@truckRequest.Time</td>
                                    <td>@truckRequest.RequestFor</td>
                                    <td>@(truckRequest.Res_Id ?? 0)</td>
                                    <td>@(truckRequest.AllotId ?? 0)</td>
                                    <td>@truckRequest.Status</td>

                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        </div>
    </div>
    <script>

    $(document).ready(function () {
     //   $("#Reject").click(function () {
            $('#Reject').on('click', function (event) {
                event.preventDefault();
                var $btn = $(this); // Reference to the button
                if ($btn.prop('disabled')) {
                    return; // Exit if the button is already disabled
                }

                $btn.prop('disabled', true); // Disable the button to prevent further clicks

            var form = {
                Allot_id: $(this).data('vid'),
                Date: $(this).data('date'),
                Destination: $(this).data('destination'),
                Source: $(this).data('source'),
                D_time: $(this).data('end-time'),
                S_time: $(this).data('start-time')
            };            // Add your logic for rejecting here
              $.ajax({
                type: 'POST',
                url: '@Url.Action("Rejectrequest", "Admin")', // Correctly resolve the URL
                 data: { data: form },
                success: function(response) {
                    alert('Vehicle allotted successfully!');
          // Optionally disable the button to prevent re-submission
                    $(this).prop('disabled', true);
                window.location.href = "@Url.Action("Reject", "Admin")"; // Redirect

                  },
                    error: function(xhr, status, error) {
                    alert('Error: ' + error);
                    }
               });
        });
    $('.allot-btn').on('click', function() {
        var form = {
            Allot_id: $(this).data('vid'),
            Date: $(this).data('date'),
            Destination: $(this).data('destination'),
            Source: $(this).data('source'),
            D_time: $(this).data('end-time'),
            S_time: $(this).data('start-time')
        };
// Fetching vehicle ID from data attribute
        $.ajax({
            type: 'POST',
            url: '@Url.Action("request", "Admin")', // Correctly resolve the URL
            data: { data: form },
            success: function(response) {
                alert('Vehicle allotted successfully!');
                // Optionally disable the button to prevent re-submission
                $(this).prop('disabled', true);
                 window.location.href = "@Url.Action("Check", "Admin")"; // Redirect

            },
            error: function(xhr, status, error) {
                alert('Error: ' + error);
            }
        });
    });
});
    </script>


